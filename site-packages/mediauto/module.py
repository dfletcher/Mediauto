#!/usr/bin/env python

import os

processors = {}

def scan_plugins(directories):
  def _visit(_a, dir, files):
    for file in files:
      base, ext = os.path.splitext(file)
      if ext == '.py': execfile(os.path.join(dir, file), globals())
  for directory in directories:
    os.path.walk(directory, _visit, None)

def processor_register(processor_type, processor_class):
  global processors
  processors[processor_type] = processor_class

def processor_instance(processor_type, media_info):
  global processors
  if not processor_type in processors: return None
  return processors[processor_type](media_info)
